parameters:
  commerce_cart_api:
    use_cart_token_session: false
services:
  access_check.cart_api:
    class: Drupal\commerce_cart_api\Access\CartApiAccessCheck
    arguments: ['@commerce_cart.cart_provider']
    tags:
      - { name: access_check, applies_to: _cart_api }

  commerce_cart_api.routing_alter_subscriber:
    class: Drupal\commerce_cart_api\EventSubscriber\RoutingAlterSubscriber
    tags:
      - { name: 'event_subscriber' }

  commerce_cart_api.field_access:
    class: Drupal\commerce_cart_api\FieldAccess
    arguments: ['@current_route_match']

  paramconverter.commerce_jsonapi.cart_uuid:
    parent: paramconverter.entity
    class: Drupal\commerce_cart_api\ParamConverter\CartUuidConverter
    tags:
      # Priority 15, to ensure it runs before @paramconverter.jsonapi.entity_uuid
      - { name: paramconverter, priority: 15 }

  commerce_cart_api.jsonapi_controller_shim:
    parent: jsonapi.entity_resource
    class: Drupal\commerce_cart_api\Controller\jsonapi\EntityResourceShim
